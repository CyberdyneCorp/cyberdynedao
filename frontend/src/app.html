<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script>
			// Global error handlers for unhandled promises and initialization issues
			window.addEventListener('unhandledrejection', function(event) {
				console.warn('[ERROR HANDLER] Unhandled promise rejection:', event.reason);
				
				// Don't prevent default for critical errors, but log them
				if (event.reason && typeof event.reason === 'object') {
					if (event.reason.message && (
						event.reason.message.includes('Cannot access uninitialized variable') ||
						event.reason.message.includes('ReferenceError')
					)) {
						console.warn('[ERROR HANDLER] Suppressing initialization error to prevent UI blocking');
						event.preventDefault(); // Prevent console error spam
					}
				}
			});
			
			// Inline polyfills for immediate availability
			(function() {
				// Buffer polyfill
				if (typeof window !== 'undefined' && typeof window.Buffer === 'undefined') {
					console.log('[POLYFILLS] Loading Buffer polyfill inline...');
					// Simple Buffer polyfill placeholder - actual Buffer will be loaded by Vite
					window.Buffer = window.Buffer || {};
				}
				
				// Global polyfills
				if (typeof global === 'undefined') {
					var global = globalThis || window;
				}
				
				if (typeof process === 'undefined') {
					var process = {
						env: {},
						nextTick: function(fn) { setTimeout(fn, 0); },
						browser: true,
						version: '',
						versions: {},
						platform: 'browser'
					};
				}

				// Make available globally
				window.global = global;
				window.process = process;
				
				console.log('[POLYFILLS] Inline polyfills loaded');
			})();
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
